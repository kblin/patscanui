{% extends "layout.html" %}
{% block body %}
<div id="contents">
  <h2 id="usage">Basic Usage</h2>
  <div>
    <p>
    As a first step, you need to upload a sequence file in FASTA format.
    This is the sequence you can search using PatScan. The file will be
    kept on the server as long as you work on it and deleted an hour
    after you finished using the software.
    </p>
    <p>
    Once your file is uploaded, you can specify a pattern by dragging
    pattern elements from the menu bar on the right side of the screen
    to the work area. Once the pattern element is on the work area, you
    can fill in details, and reorder the elements by dragging them
    around.
    </p>
    <p>
    Above the pattern area, there is a configuration menu containing a
    couple of buttons to adjust the software.
    </p>

    <p>
    The <b>DNA/Protein</b> selector allows you to tell PatScan what
    kind of sequence file you uploaded.  This affects the selection of
    available pattern elements.
    </p>

    <p>
    While working on the pattern, you can switch on the <b>continuous
      preview</b>, that will regularly search your uploaded sequence
    for the currently selected pattern. This will allow you to tweak
    the pattern until you get the desired result.
    </br>

    <p>
    If you want to get rid of the current pattern elements, you can
    clear all of them using the <b>clear</b> button. Alternatively, you
    may drag single elements onto the trash on the right hand menu.
    </p>

    <p>
    If you want to get an example of many of the possible pattern elements,
    you can load an <b>example</b>.
    </p>

    <p>
    Below the work area, you can expand the <b>computed pattern</b>
    view, in case you need to tweak the generated pattern manually
    </p>
  </div>

  <h2 id="patterns">Available Patterns</h2>
  <p>
    PatScan supports many different pattern types, here we will explain how they work.
  </p>

  <div id="accordion">
    <h3 id="string"><a href="#">String Pattern</a></h3>
    <div>
      <p>This is how string patterns work</p>
    </div>

    <h3 id="range"><a href="#">Range Pattern</a></h3>
    <div>
      <p>Explanation of range patterns</p>
    </div>

    <h3 id="complement"><a href="a">Complement Pattern</a></h3>
    <div>
      <p>Explanation of the complement pattern</p>
    </div>

    <h3 id="repeat"><a href="a">Repeat Pattern</a></h3>
    <div>
      <p>Explanation of the repeat pattern</p>
    </div>

    <h3 id="alternative"><a href="a">Alternative Pattern</a></h3>
    <div>
      <p>Explanation of the alternative pattern</p>
    </div>

    <h3 id="lengthlimit"><a href="a">Length limit Pattern</a></h3>
    <div>
      <p>Explanation of the length limit pattern</p>
    </div>

    <h3 id="weight"><a href="a">Weight Pattern</a></h3>
    <div>
      <p>Explanation of the weight pattern</p>
    </div>

    <h3 id="anyof"><a href="a">Any-Of Pattern</a></h3>
    <div>
      <p>Explanation of the any-of pattern</p>
    </div>

    <h3 id="notanyof"><a href="a">Not-Any-Of Pattern</a></h3>
    <div>
      <p>Explanation of the not-any-of pattern</p>
    </div>

    <h3 id="altcomplementrule"><a href="a">Alternative Complementation Rule</a></h3>
    <div>
      <p>Explanation of the alternative complementation rule</p>
    </div>
  </div>

  <h2 id="codes">Nucleotide Ambiguity Codes</h2>
  <div>
    <p>
    <table id="ambiguity-table">
      <thead>
        <tr>
          <td class="legend">Code</td>
          <td>M</td>
          <td>R</td>
          <td>W</td>
          <td>S</td>
          <td>Y</td>
          <td>K</td>
          <td>V</td>
          <td>H</td>
          <td>D</td>
          <td>B</td>
          <td>N</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="legend">Nucleotides</td>
          <td>AC</td>
          <td>AG</td>
          <td>AT</td>
          <td>CG</td>
          <td>CT</td>
          <td>GT</td>
          <td>ACG</td>
          <td>ACT</td>
          <td>AGT</td>
          <td>CGT</td>
          <td>ACGT</td>
        </tr>
      </tbody>
    </table>
    </p>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename="js/jquery-ui-1.8.22.custom.min.js") }}"></script>
<script src="{{ url_for('static', filename="js/jquery.ui.touch-punch.min.js") }}"></script>
<script type="text/javascript">

function findTopicIdx(topic) {
  var topics = $('#accordion').children('h3');
  console.log('topic is ' + topic);
  for (var i=0; i < topics.length; i++) {
    console.log('current is ', topics[i].id);
    if (topics[i].id == topic) {
      return i;
    };
  }
  return -1;
}

function setActiveTopic(topic) {
  var idx = findTopicIdx(topic);
  if (idx < 0) return;
  $('#accordion').accordion('option', 'active', idx);
}

$(document).ready(function() {
  $('#accordion').accordion({
    active: false
  });
  setActiveNav(window.location.pathname.slice(1));
  setActiveTopic(window.location.hash.slice(1));
});
</script>
{% endblock %}
